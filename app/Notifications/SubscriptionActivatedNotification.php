<?php

namespace App\Notifications;

use App\Enums\SubscriptionLevelEnum;
use App\Models\PurchasedSubscription;
use Illuminate\Bus\Queueable;
use Illuminate\Contracts\Queue\ShouldQueue;
use Illuminate\Notifications\Messages\MailMessage;
use Illuminate\Notifications\Notification;

class SubscriptionActivatedNotification extends Notification implements ShouldQueue
{
    use Queueable;

    /**
     * –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —á—Ç–æ-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Å—ã–ª–∫—É).
     *
     */
    protected PurchasedSubscription $subscription;

    /**
     * –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.
     *
     * @param PurchasedSubscription $subscription
     * @return void
     */
    public function __construct(PurchasedSubscription $subscription)
    {
        $this->subscription = $subscription;
    }

    /**
     * –ü–æ–ª—É—á–∏—Ç—å –∫–∞–Ω–∞–ª—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã.
     *
     * @param mixed $notifiable
     * @return array
     */
    public function via($notifiable)
    {
        return ['mail']; // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ email
    }

    /**
     * –ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ.
     *
     * @param mixed $notifiable
     * @return \Illuminate\Notifications\Messages\MailMessage
     */
    public function toMail($notifiable)
    {
        $subscriptionLevel = SubscriptionLevelEnum::getDescription($this->subscription->subscription_level);

        $mail = (new MailMessage)
            ->subject('–ü–æ–¥–ø–∏—Å–∫–∞ "' . $subscriptionLevel . '" –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞')
            ->greeting('–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, ' . $notifiable->fullName . ',');

        if ($this->subscription->subscription_level == SubscriptionLevelEnum::B) {
            $mail->line('–í—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–æ–±—Ä–µ–ª–∏ —Ç–∞—Ä–∏—Ñ B!')
                ->line('–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –æ—Ç–∫—Ä—ã—Ç –¥–æ—Å—Ç—É–ø –∫ —Ä–∞–∑–º–µ—â–µ–Ω–∏—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ–±–µ –≤ –Ω–∞—à–µ–º —Ä–µ–µ—Å—Ç—Ä–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Å –¥–µ—Ç—å–º–∏ —Å –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è–º–∏ —Ä–∞–∑–≤–∏—Ç–∏—è.')
                ->line('**–í–∞—à–∏ –¥–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏:**')
                ->line('1) –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –Ω–∞ —Å–∞–π—Ç –∏ –¥–æ–±–∞–≤—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É')
                ->line('2) –ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤—ã —Å–º–æ–∂–µ—Ç–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ—é –∫–∞—Ä—Ç–æ—á–∫—É —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞')
                ->line('3) –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ —Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é –≤—ã —Ö–æ—Ç–µ–ª–∏ –±—ã –≤–∏–¥–µ—Ç—å –Ω–∞ —Å–≤–æ–µ–π —Å—Ç—Ä–∞–Ω–∏—á–∫–µ')
                ->line('**–†–∞–∑–º–µ—â–µ–Ω–∏–µ –≤ —Ä–µ–µ—Å—Ç—Ä–µ ‚Äî —ç—Ç–æ:**')
                ->line('‚Äì –≤–∞—à–∞ –≤–∏–∑–∏—Ç–∫–∞, –¥–æ—Å—Ç—É–ø–Ω–∞—è —Ä–æ–¥–∏—Ç–µ–ª—è–º –∏ –∫–æ–ª–ª–µ–≥–∞–º –ø–æ –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–µ;')
                ->line('‚Äì –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—ã—Ç—å –∑–∞–º–µ—á–µ–Ω–Ω—ã–º –ø—Ä–∏ –ø–æ–∏—Å–∫–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º;')
                ->line('‚Äì —É—á–∞—Å—Ç–∏–µ –≤ —Å–∏—Å—Ç–µ–º–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –æ—Ç –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.')
                ->line('–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã ‚Äî –ø–∏—à–∏—Ç–µ, –ø–æ–º–æ–∂–µ–º!')
                ->action('–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞', route('join.specialist'));
        } elseif ($this->subscription->subscription_level == SubscriptionLevelEnum::C) {
            $mail->line('–í—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–æ–±—Ä–µ–ª–∏ —Ç–∞—Ä–∏—Ñ C!')
                ->line('–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–º —Ü–µ–Ω—Ç—Ä–µ –≤ —Ä–µ–µ—Å—Ç—Ä–µ ABA-EXPERT ‚Äî –∫—Ä—É–ø–Ω–µ–π—à–µ–º —Å–æ–æ–±—â–µ—Å—Ç–≤–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Å –¥–µ—Ç—å–º–∏ —Å –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è–º–∏ —Ä–∞–∑–≤–∏—Ç–∏—è.')
                ->line('**–í–∞—à–∏ –¥–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏:**')
                ->line('1) –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å–∞–π—Ç –∏ –¥–æ–±–∞–≤—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏')
                ->line('2) –ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤—ã —Å–º–æ–∂–µ—Ç–µ –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–∞—à–µ–≥–æ —Ü–µ–Ω—Ç—Ä–∞')
                ->line('3) –£–∫–∞–∂–∏—Ç–µ –∫–ª—é—á–µ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–∂–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è–º –∏ –∫–æ–ª–ª–µ–≥–∞–º –Ω–∞–π—Ç–∏ –≤–∞—à —Ü–µ–Ω—Ç—Ä')
                ->line('**–†–∞–∑–º–µ—â–µ–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞ –≤ —Ä–µ–µ—Å—Ç—Ä–µ ‚Äî —ç—Ç–æ:**')
                ->line('‚Äì –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤;')
                ->line('‚Äì —É—á–∞—Å—Ç–∏–µ –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º —Å–æ–æ–±—â–µ—Å—Ç–≤–µ –∏ –¥–æ—Å—Ç—É–ø –∫ –∑–∞–∫—Ä—ã—Ç—ã–º –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º;')
                ->line('‚Äì –ø–æ–≤—ã—à–µ–Ω–∏–µ –¥–æ–≤–µ—Ä–∏—è —á–µ—Ä–µ–∑ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Ç –ø—Ä–æ–µ–∫—Ç–∞.')
                ->line('–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã ‚Äî –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º, –º—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ–º–æ–∂–µ–º!')
                ->action('–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ü–µ–Ω—Ç—Ä–∞', route('join.center'));
        } elseif ($this->subscription->subscription_level == SubscriptionLevelEnum::A) {
            $mail->line('–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!')
                ->line('–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –≤–∞—Å –∑–∞ –ø–æ–∫—É–ø–∫—É —Ç–∞—Ä–∏—Ñ–∞ –∏ –¥–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ ABA-EXPERT ‚Äî —Ä–æ—Å—Å–∏–π—Å–∫–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –≤ –æ–±–ª–∞—Å—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è.')
                ->line('–ú—ã —Ä–∞–¥—ã, —á—Ç–æ –≤—ã —Å –Ω–∞–º–∏, –∏ —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ –≤–º–µ—Å—Ç–µ –º—ã —Å–º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å –ø–æ–º–æ—â—å –¥–µ—Ç—è–º —Å –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è–º–∏ —Ä–∞–∑–≤–∏—Ç–∏—è –µ—â—ë –±–æ–ª–µ–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π, —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏ –¥–æ—Å—Ç—É–ø–Ω–æ–π.')
                ->line('üéÅ –í –∑–Ω–∞–∫ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏ –¥–∞—Ä–∏–º –≤–∞–º –ø—Ä–æ–º–æ–∫–æ–¥ –Ω–∞ 1000 —Ä—É–±–ª–µ–π –Ω–∞ –ª—é–±—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ –Ω–∞—à–µ–º –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–æ–º –ø—Ä–æ–µ–∫—Ç–µ [aba-family.ru](https://aba-family.ru/).')
                ->line('**–ü—Ä–æ–º–æ–∫–æ–¥:** 1000 (–≤–≤–æ–¥–∏—Ç–µ –µ–≥–æ –Ω–∞ —ç—Ç–∞–ø–µ –æ–ø–ª–∞—Ç—ã)')
                ->line('–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –Ω—É–∂–Ω–∞ –±—É–¥–µ—Ç –ø–æ–º–æ—â—å ‚Äî –ø–∏—à–∏—Ç–µ, –≤—Å–µ–≥–¥–∞ –Ω–∞ —Å–≤—è–∑–∏.')
                ->action('–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç', route('home'));
        }

        return $mail;
    }



    /**
     * –ü–æ–ª—É—á–∏—Ç—å –º–∞—Å—Å–∏–≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ –¥—Ä—É–≥–∏–µ –∫–∞–Ω–∞–ª—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, SMS).
     *
     * @param mixed $notifiable
     * @return array
     */
    public function toArray($notifiable)
    {
        return [
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
        ];
    }
}
